---
title: 关于EIP-1559协议
top: false
cover: false
toc: true
mathjax: true
date: 2021-10-24 10:57:13
password:
summary:
tags:
- 以太坊
categories:
- 区块链
---

# 写在前面
比特币以一种全新的思路重建了货币体系，这个传统情况下被认为一定需要权威中心（政府）背书和管理的核心金融基础设施，以太坊则带来了由加密货币到去中心化应用生态爆发，从ICO到Defi，再到NFT，区块链已经越来越接近真实生活。秉承去中心化理念的全面应用，以太坊升级也是去中心化的，任何一个feature改进或升级都需要参与者共同确认，因为EIP（以太坊改进提案）应运而生，而EIP1559则可视为以太坊最重要的提案之一，因为它的目的是改革ETH的Gas费定价机制，让用户以合理可接受的成本使用以太坊。

# 以太坊提案EIP-1559
EIP-1559是以太坊的重要提案，它对未来ETH的价值捕获、用户体验、安全性等方面都会产生重大影响。中短期内，EIP-1559提案对ETH的价格冲击力可能仅次于ETH的PoS，从长期看，可能会有更持久的影响力。

## 什么是EIP-1559？
EIP-1559本质上是关于以太坊网络交易定价机制的解决方案，它包括每区块网络费用的固定部分base fee（也就是基础费用，会被销毁，矿工收不到这笔费用），同时还有动态的可伸缩的区块大小设计，以应对瞬时的网络拥堵。

虽然每区块的基础费用是固定的，但是它会根据网络的拥堵情况，调节每区块的基础费用，它有一个公式用来调整基础费用的上升或下降。它会根据上一个区块所用的gas和目标gas（gas target，也就是之前的gas limit）来调整。当区块高于目标gas价格，基础费用上升，当区块低于目标gas价格，基础费用下降。

除了基础费用，还可以有打赏费用（小费）。在拥堵时，小费用于激励矿工将用户交易打包进区块。交易可以指定基础费用和小费的上限。这一提案还包括过渡性方案。开始时，区块的一半保留原来的竞价机制，一半采用新的费用机制，并逐渐过渡到新的方案。

这里有几个关键点：

费用结构

基本费用+小费

费用流向

基本费用会被销毁，矿工无法获得；矿工的收益主要是新增区块奖励+小费

弹性区块

可伸缩区块用以应对网络拥堵，同时基本费用也根据拥堵情况进行调整。

![eip1559提案](eip1559.jpeg)

## 为什么要搞EIP-1559？
对发生在以太坊上的交易，目前的收费方案是拍卖机制。由用户出价，矿工选择出价最高的交易，将其打包进区块。这种方式看上去简单且高效，不过也有问题：

竞价的低效率

以太坊上的最低出价可能会存在极大的差异。这导致出价效率低下。用户发送交易时选择出价的费用上限，而矿工选择最高出价的交易。对用户来说，出价多少合适是很难预估的，即便有复杂的费用预估算法，也不太可能做到很好的估算，经常会出现超额费用支付的情况。

造成延误

由于每区块gas limit的限制和交易量的自然波动，这会导致交易可能需要等待几个区块才能被打包进入。对用户来说，可能会造成延误。而EIP-1559提出弹性区块的机制，可以让一个区块变大，而下一个区块变小，实现更长期的平均区块大小限制，允许不同区块存在一定的大小差异。这解决了当前一些区块过满，而一些区块使用过少的现状。

安全性

随着区块奖励的减少（如比特币和Zcash），未来交易费成为奖励矿工的主要来源。因此需要有足够的交易规模来支撑网络的安全，同时还可能会导致矿工的自私挖矿等问题，产生一些不稳定因素。

EIP-1559为了解决上述问题，它改变了付费结构和付费流向：将交易费用分为基本费用+小费，同时基本费用被销毁，矿工无法获得，矿工可以获得打赏费用，也可以获得新增发的区块奖励，从而减少矿工操纵交易费用的动机，并让包括矿工在内各种参与者有机会获益。

此外，在EIP-1559的设计中，当网络超出每区块目标gas使用量，基本费用会在接下来的区块增加，而当容量低于目标gas使用量，则下降。因此，gas费用的变化是根据需求情况进行调整的，其区块之间的费用差异是可预测的。

这对于用户体验来说会有提升。EIP-1559实施之前的以太坊采用的是类似于比特币的第一价格拍卖机制（First Price Auctions），其缺点之一是需要进行费用估算。而EIP-1559则对所有交易尽可能实施相同的费率。用户需要决定的是是否支付费用，而不用太多考虑出价多少。钱包可以帮助用户预测基本费用以及自动设置一点打赏费用，减少了大多数用户手动调整gas费用的操作。当然，如果用户手动设置交易费用上限也是可以的,用户通过手动设置费用上限可以限制其最高成本。

除了用户体验提升，还可以提升以太坊的安全性以及解决经济抽象等问题。

由于矿工在交易费用中仅仅捕获打赏费用，而基本费用被协议销毁，这样可以消除矿工操作费用以获得更多费用的动机。更重要的是，它改变了ETH的价值捕获机制。之前的ETH更多代表了以太坊上价值流通和价值存储，本身并没有捕获费用价值。

而基本费用改变了这一局面。基本费用的捕获意味着ETH开始捕获以太坊网络的交易费用，而交易费用的多少取决于以太坊上交易规模。随着以太坊交易规模的增大，ETH可以捕获的费用就越多。

同时，在EIP-1559实施前的以太坊交易费用支付中，并不是一定得用ETH支付。而实施之后基本费用是使用ETH支付，这也在一定程度上解决了之前讨论的“经济抽象”的问题。所谓的“经济抽象”，就是说用户可以使用稳定币或其他代币支付手续费。这不仅会威胁原生代币ETH在网络中的位置，而且也不利于网络安全。EIP-1559要求消耗特定数量的ETH，会增加经济抽象的难度。

如果以太坊上的交易规模足够大，那么它可以捕获大量的基本费用，这些用ETH支付的基本费用会被销毁，这会降低ETH的通胀率，甚至可能通缩的情况（假设增发低于销毁）。这有利于ETH的价值支撑。

从安全性来看，在比特币的激励中，当区块补贴完毕，它主要依靠交易费用来维持其安全，这种模式如何获得可持续目前还是存在争议的。而以太坊通过将交易手续费销毁，并将矿工激励通过区块奖励持续运作下去。这是一个更为弹性的机制。由于交易手续费销毁，价值转移到ETH上，以太坊采用ETH区块奖励对矿工进行补贴，这为以太坊安全的长期可持续提供了基础。

## EIP-1559对ETH价值的支撑
通过过去一段时间的实践，我们可以看到单纯挖矿代币的价值支撑存在很大的问题。有些挖矿奖励代币，或者说是所谓的“治理代币”，有很大的抛压，但价值支撑不够，最终导致币价下跌，激励下降，甚至出现了不少死亡螺旋的代币。

有些头部DEX交易量很好，流动性也不错，协议的年化手续费用也非常高，基本面一片大好，但同样也无法支撑起价值。因为它们也同样面临“挖卖提”的情况。其代币本身只是“治理代币”，没有捕获协议价值。目前的协议费用中，绝大部分收益依然没有融入到代币中来，而是直接分给LP。这意味着代币和协议的价值成长并没有达成高度融合。这就是在当前情况下它们的价值无法支撑的原因所在。当然，未来这种局面可能会随着治理的深入发生改变，因为治理本身可以改变这个局面。目前的治理代币更多是代表了未来的可能性。

EIP-1559对ETH的影响也是类似的。EIP-1559实施之前的ETH并没有捕获到以太坊网络费用的价值，这导致ETH在泡沫破灭时完全无法实现价值的支撑，从泡沫时最高的近1500美元跌至底点的100多美元。

而EIP-1559之前的ETH将捕获以太坊网络的费用价值，截止到蓝狐笔记写稿时，以太坊的年化网络费用超过了13亿美元，这是一笔不小的费用。

这意味着，未来ETH除了作为价值存储和价值媒介之外，还可以真正捕获到大规模的价值。就其当前价值捕获的规模看，它是目前所有公链中最强势的，这让ETH在未来有更坚实的价值支撑。

